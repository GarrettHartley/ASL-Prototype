<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ASL 101</title>
<link href="style.css" rel="stylesheet" type="text/css">
<script src="objects.js"></script>
<script src="vid.js"></script>
<script>
//********************
//    For the LOGIN
//********************


function create_account() {
	document.getElementById("login").innerHTML =
			"<div id='account'>" +
			"Choose Username:<br>" +
			"<input type='text' name='user_id' size='30'>"+
			"<div id='acc' onclick='login()' style='cursor: pointer'>Login</div>"+
			"Choose Password:<br>"+
			"<input type='password' name='password' size='30' height='10'>"+
			"<br><br>"+
			"Re-enter Password:<br>"+
			"<input type='password' name='password2' size='30' height='10'>"+
			"<br><br>"+
			"<input type='submit' value='Continue' onclick='login()'>"+
			"</div>";
}

function lookup(){
  var word = document.getElementById("search_input").value
  if(dict[word]){

    videoPlayback(word)
    unit(dict[word].unit)
    console.log("Inside lookup"+dict[word].unit)

  } else {
    requestWord(word);
  }
}


function selectTab(){

  console.log("eventTarget"+event.target);
  var prevtab = document.querySelectorAll(".navbtn.selected");
  prevtab[0].className = prevtab[0].className.replace("navbtn selected", "navbtn");
  event.target.className = "navbtn selected"


}
function selectWord(){
  console.log("hahahhahahahha"+event.target.className)
  if(event.target.className!='find'){
    document.querySelector(".wordbtn.selected").className="wordbtn"
    event.target.className="wordbtn selected"
  }
  else{
    console.log('ahahhasdfasdfasdfasfd');
  }
}

function selectUnit(){
  // initialWordSelect='true';
  if(initialUnitSelect=="false"){
     var prevUnit = document.querySelectorAll(".unitbtn.selected");
      prevUnit[0].className = prevUnit[0].className.replace("unitbtn selected", "unitbtn");
        if(event.target.className!='find'){
        event.target.className = "unitbtn selected"
        }
        else{
          selectWord()
        }
    }
  else{
    initialUnitSelect = "false";
  }

}

function login() {
	document.getElementById("login").innerHTML =
			"<div id='input'>" +
			"Username:<br>" +
			"<input type='text' name='user_id' size='30'><br><br>"+
			"<div id='acc' onclick='create_account()' style='cursor: pointer'>Create an account</div>"+
			"Password:<br>"+
			"<input type='password' name='password' size='30' height='10'>"+
			"<br><br>"+
			"<input type='submit' value='Login' onclick='initial_load()'>"+
			"</div>";

}
var x = 'user';
function initial_load() {
	x = document.getElementById('user_id').value;
	if(x === "professor" || x === "Professor")
	{
		document.getElementById("page_content").innerHTML = "<div class='navigation'>"+
      	"<ul><li><a href='javascript:;' class='navbtn' onclick='dictionary();selectTab()'>Dictionary</a></li>"+
        "<li><a href='javascript:;' class='navbtn' onclick='fingerSpeller();selectTab()'>Finger Speller</a></li>"+
        "<li><a href='javascript:;' class='navbtn' onclick='videoPlayback();selectTab()'>Video Playback</a></li>"+
        "<li class='navbtn' ><a href='javascript:;'  onclick='myWords();selectTab()'>My Words</a></li>"+
        "<li><a href='javascript:;' class='navbtn' onclick='viewRequests();selectTab()'>View Requests</a></li>"+
        "<li class='navbtn' style='color: yellow; float: right; padding-right: 10px'><span id='user_name' onclick='login();selectTab()'></span></li>"+
    	"</ul></div><br><div class='right_section'><div class='common_content'><p id='main_content_area'></p></div></div>"+
    	"<div class='clear'></div><div id='footer'><br></div>";
	}
	else{
	document.getElementById("page_content").innerHTML = "<div class='navigation'>"+
      "<ul><li><a href='javascript:;' class='navbtn' onclick='dictionary();selectTab()'>Dictionary</a></li>"+
        "<li><a href='javascript:;' class='navbtn' onclick='fingerSpeller();selectTab()'>Finger Speller</a></li>"+
        "<li><a href='javascript:;' class='navbtn' onclick='videoPlayback();selectTab()'>Video Playback</a></li>"+
        "<li class='navbtn' ><a href='javascript:;'  onclick='myWords();selectTab()'>My Words</a></li>"+
        "<li><a href='javascript:;' class='navbtn' onclick='requestWord();selectTab()'>Request a word</a></li>"+
        "<li class='navbtn' style='color: yellow; float: right; padding-right: 10px'><span id='user_name' onclick='login();selectTab()'></span></li>"+
    	"</ul></div><br><div class='right_section'><div class='common_content'><p id='main_content_area'></p></div></div>"+
    	"<div class='clear'></div><div id='footer'><br></div>";
    	}
	document.getElementById('user_name').innerHTML = 'Welcome,  ' + current_user;
    	dictionary();

}
//************************
function viewRequests() {
	var html_string = "<table id='wrds'><tr><th id='wrds'>Word</th><th id='wrds'>Times Requested</th></tr>";
	for(var wrd in requested_words){
		html_string += "<tr><td id='wrds'>" + requested_words[wrd]['word'];//Needs to display the words and user who requested them
		html_string +=  "</td><td id='wrds'>" + requested_words[wrd]['num_requests'] + "</td></tr>";
	}
	html_string += "</table>";
	document.getElementById("main_content_area").innerHTML = html_string;
}


function unit(num){
  selectUnit();
  document.getElementById("unit1_words").innerHTML="";
  document.getElementById("unit2_words").innerHTML="";
  document.getElementById("unit3_words").innerHTML="";


  var html_string = "<ul id='unitWords>'";
   for(var wrd in dict){
   if(dict[wrd]["unit"]==num){
    html_string += "<li><button id='"+dict[wrd]["Display"]+"' class='wordbtn' onclick=\"videoPlayback(\'"+ dict[wrd]["Display"] +"\');selectWord()\">";
    html_string += dict[wrd]["Display"];
    html_string += "</button></li>";
   }
   }
    html_string += "</ul>";
  document.getElementById("unit"+num+"_words").innerHTML = html_string;
  document.querySelector(".wordbtn").className="wordbtn selected";
  console.log("This is the selected word: "+document.querySelector(".wordbtn.selected").getAttribute('id'))
  videoPlayback(document.querySelector(".wordbtn.selected").getAttribute('id'))
  // selectWord();
  console.log("@@@@"+document.querySelector(".wordbtn").className);
}


function removeWord(wordID){
    for(var key in user_words) {
      console.log(key);
      console.log(wordID.id);
      if( key == wordID.id){
         delete user_words[key];
    }
  }

  console.log(user_words);
  wordID.remove();
  if(i == 0)
{
var html_string = "<p style='text-align: center; color: black; font-size: 20px; font-family: Century Gothic'>No current favorited videos</p>";
document.getElementById("main_content_area").innerHTML = html_string;
}

}


function myWords(){
	var html_string = "<br><ul class='myList'>";
	var i = 0;
	for(var wrd in user_words){
	i++;
    if(user_words[wrd]["username"]==current_user){
	   	html_string += "<li id="+wrd+" class='mywords_list'><div class='myWordsItem' ><div class='wrd_btn'>";
	   	html_string += user_words[wrd]["Display"];
	   	html_string += "</div>"+"<button  class='remove' onclick=\"removeWord("+wrd+")\">X</button>"+"<div class='myWordsImgContainer'   >"+
       "<img src=\"teacher_vids/"+ wrd +".jpg\" style=\"   width:700px;height:500px\"  onclick=\"recorder("+wrd+")\"></div></div></li>";
    }
  }
	html_string += "</ul>";
  if(i == 0)
  {
  	html_string = "<p style='text-align: center; color: black; font-size: 20px; font-family: Century Gothic'>No current favorited videos</p>";
  }
 
	document.getElementById("main_content_area").innerHTML = html_string;

}


function requestWord(wrd){
if(!wrd)
{
	wrd = "";
}
  document.getElementById("main_content_area").innerHTML="<br><form id='rqst'><h3>Word:</h3><input type=\"text\" value='"+wrd+"' name=\"word\"><br>" +
  "<br><h3>Name:<h3><input type=\"text\" name=\"name\"><br><br><input type=\"submit\" value=\"Submit\"></form>";
  
    // document.getElementById("left_side_bar").innerHTML = "";


}

function favoriteVideo(word){
  console.log(word);
   if(!(word in user_words)){
    console.log(word);
    document.querySelector('#star').src = 'Widgets/star_clicked.png';
    user_words[word] = {url: 'url/ant', Display: word, username: current_user};
   }
   else{
    document.querySelector('#star').src = 'Widgets/star.png';
    delete user_words[word]
    console.log(word);
   }
}

function recorder(word){
  console.log(word.getAttribute('id'));
  // console.log(user_words[word]["Display"]);
  document.getElementById("main_content_area").innerHTML= "<br><br><button  class=\"btn\" onclick=\"myWords()\">Back</button>"+
  "<video width=\"400\" controls><source src=\"teacher_vids/" + word.getAttribute('id').toLowerCase()
   + ".mp4\" type=\"video/mp4\"></video></div>"; 
  
}

function videoPlayback(word){
  // dictionary();



	console.log("videoPlayback: "+word);
  html = "";
  html += "<div id='videoContainer'><div id='favoriteVideo' onclick= favoriteVideo('"+word+"')>";

  if(word in user_words){
      html +="<img id='star' src='Widgets/star_clicked.png'></div>";
  }
  else{
     html+="<img id='star' src='Widgets/star.png'></div>";
  }


	html += "<video width=\"400\" controls><source src=\"" + dict[word]["url"] + ".mp4\" type=\"video/mp4\"></video></div>";

	html += document.getElementById("video_playback").innerHTML;
    document.getElementById("dictionary_video").innerHTML= html;
}

function dictionary(){
  initialUnitSelect = true;

   var html_string = "<div id ='left_side_bar' class='left_side_bar'>"+
         "<div class='box'>"+
           "<ul id='units'>"+

             "<li><button class='unitbtn selected' onclick='unit(1)'>unit 1</button><div id ='unit1_words'></div></li>"+
             "<li><button class='unitbtn' onclick='unit(2)'>unit 2</button><div id ='unit2_words'></div></li>"+
             "<li><button class='unitbtn' onclick='unit(3)''>unit 3</button><div id ='unit3_words'></div></li>"+

           "</ul>"+
         "</div>"+
       "</div>"+
   "</div>"

   /*html_string += "<form id='tfnewsearch' method='get' action='http://www.google.com'>"+
           "<input type='text' class='tftextinput' name='q' size='21' maxlength='120'><input   type='submit' value='search'"+
           "class='tfbutton'> </form>"+
           "<div id='dictionary_video'></div>"*/

           html_string+="<div id='searchContainer'><input type='text' id='search_input'>"+
          "<div id='findContainer'><button type='button' class ='find' onclick='lookup()'>Find</button></div> </div>"

					html_string += "<div id='dictionary_video'></div>"

	document.getElementById("main_content_area").innerHTML = html_string;
  // document.getElementById("main_content_area").innerHTML = left_html_string;
  unit(1);

  videoPlayback(dict['Salt']["Display"]);
}

function player(){
  document.getElementById("main_content_area").innerHTML= "<div id = videoConainer><video width=\"400\" controls><source src=\"stubb.mp4\" type=\"video/mp4\"></video></div>"

}



//****************************************************
//          Start Finger Speller Funcions
//****************************************************

function fingerSpeller(){
  document.getElementById("main_content_area").innerHTML= "<div id=' FScontainer'>" +
    "<div id='imgContainer'>" +
      "<img id='spellerImage' src='letter_images/A.GIF'>"+
    "</div>"+
    "<div id='FScontrols'>"+
      "<ul>"+
        "<li id='pause' onclick='pause()' class='btn'><div class='buttonContainer'><img id='pauseCSS' src='Widgets/pause.png'></div>"+
          "</li>"+
        "<li id='play' onclick='play()' class='btn' ><div class='buttonContainer'><img id ='playCSS' src='Widgets/play.png'></div>"+
          "</li>"+
        "<li id='slower' class='btn' onclick='slower()' >slower"+
         "</li>"  +
       "<li id='faster' class='btn' onclick='faster()'>faster"+
          "</li> " +
        "<li id='prev' class='btn' onclick='previous()''><div class='buttonContainer'><img id='leftCSS' src='Widgets/l_arrow.png'></div>"+
          "</li> "+
        "<li id='next' class='btn' onclick='next()'><div class='buttonContainer'><img id='rightCSS' src='Widgets/r_arrow.png'></div>"+
          "</li> " +
        "<li ><input id='inputWord' type='text'>" +
        "</li>" +
     "</ul>" +
    "<div>" +
  "<div>"

    // document.getElementById("left_side_bar").innerHTML = "";


}

var currentFSWord = "";
var charIndex = 0;
var isPaused = false;
var counter = 0;
var speed = 1000;

function play(){
  // if(isPaused == true){
  //   isPaused = false;
  // }
  // else{
  //   isPaused = true;
  // }

    currentFSWord = document.getElementById('inputWord').value;
    var timer = setInterval(function () {
        console.log("turn no. " + charIndex);
        if (isPaused==true) {
          isPaused = false;
            clearInterval(timer);
        }

        display();
      console.log(charIndex);
      if (charIndex >= currentFSWord.length-1) {
          charIndex = 0;
          clearInterval(timer);
          return;
        }
        charIndex++;

    }, speed);

}

function pause(){
  isPaused = true;
}

function slower(){
  if(speed<2000){
    speed+=200;
  }
}

function faster(){
  if(speed>200){
    speed-=200;
  }
}


function next(){
  if(charIndex<currentFSWord.length-1){
    charIndex++;
    display();
  }
}

function previous(){
  if(charIndex>0){
    charIndex--;
    display();
  }
}

window.onload = function() {

  dictionary();
};

function display(){

  setTimeout(function() {
        document.getElementById("imgContainer").style.borderColor = "black";
}, 400);
document.getElementById("imgContainer").style.borderColor = "#3498db";
  document.getElementById('spellerImage').src = "letter_images/"+currentFSWord.charAt(charIndex).toUpperCase()+".GIF"
}

//****************************************************
//          End Finger Speller Funcions
//****************************************************

</script>
</head>
<body>

<div id="wrapper">

  <div id="header">

    <div class="top_banner">
      <img src="UpdatedLogo2.png">
    </div>

  </div>

  <div id="page_content">
    <div class='navigation'>
      <ul><li><a href='javascript:;' class='navbtn selected' onclick='dictionary();selectTab()'>Dictionary</a></li>
        <li><a href='javascript:;' class='navbtn' onclick='fingerSpeller();selectTab()'>Finger Speller</a></li>
        <li class='navbtn' ><a href='javascript:;'  onclick='myWords();selectTab()'>My Words</a></li>
        <li><a href='javascript:;' class='navbtn' onclick='requestWord();selectTab()'>Request a word</a></li>
        <li class='navbtn' style='color: yellow; float: right; padding-right: 10px'><span id='user_name' onclick='login();selectTab()'></span></li>
        <li  style='float: right; color: yellow; font-family: Century Gothic; padding-right: 10px'><span>Welcome, Joe!</span></li>
      </ul></div><br><div class='right_section'><div class='common_content'>
        <p id='main_content_area'>


<!--           <div id ='left_side_bar' class='left_side_bar'>
          <div class='box'>
           <ul id='units'>
             <li><button class='btn' onclick='unit(1)'>unit 1</button></li>
             <li><button class='btn' onclick='unit(2)'>unit 2</button></li>
             <li><button class='btn' onclick='unit(3)'>unit 3</button></li>
           </ul>
           <div id ='unit_words'></div>
            </div>
            </div>
            </div>


    <div id='dictionary_video'></div>
 -->

        </p></div></div>
      <div class='clear'></div><div id='footer'><br></div>
  </div>

</div>

***************************************
This hidden div is needed for the playback functionality
DO NOT REMOVE OR EDIT
***************************************
<div id="video_playback" hidden="true">
  <video id="video" width="680" height="400" autoplay></video>
  <canvas id="canvas" width="680" height="400"></canvas>
</div>

</body></html>
